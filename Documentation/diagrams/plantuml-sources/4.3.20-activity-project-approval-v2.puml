@startuml 4.3.20-activity-project-approval
!theme plain

' ============================================
' STYLING
' ============================================
skinparam activityFontSize 10
skinparam activityFontName Arial
skinparam backgroundColor #FAFAFA
skinparam roundcorner 5
skinparam shadowing false

skinparam activity {
    BackgroundColor #FFFFFF
    BorderColor #1976D2
    BorderThickness 2
    BarColor #1976D2
    StartColor #4CAF50
    EndColor #F44336
    DiamondBackgroundColor #FFF9C4
    DiamondBorderColor #FF9800
}

skinparam arrow {
    Color #424242
    Thickness 2
    FontSize 9
}

title <size:16><b>Project Approval Workflow - Activity Diagram</b></size>\n<size:11>UML 2.5 Activity Diagram with Swimlanes and Partitions</size>

' ============================================
' SWIMLANES
' ============================================

|#E3F2FD|Lecturer|
start
:Create project\n**<<action>>**;
note right
  **Input:**
  - Title (required)
  - Description (required)
  - Objectives (required)
  - Requirements (required)
  - Milestones (optional)
end note

:Fill project details\n**<<action>>**;

if (Use AI assistance?) then (<<yes>>)
  |#FFF9C4|System|
  :Call AWS Bedrock\n**<<service call>>**;
  :Generate milestone suggestions\n**<<automated action>>**;
  |#E3F2FD|Lecturer|
  :Review AI output\n**<<decision activity>>**;
  :Adjust milestones\n**<<action>>**;
else (<<no>>)
  :Manually create milestones\n**<<action>>**;
endif

|#E3F2FD|Lecturer|
:Validate form\n**<<validation>>**;

if (All required fields complete?) then (<<no>>)
  :Display validation errors\n**<<object flow>>**;
  stop
else (<<yes>>)
endif

:Submit for approval\n**<<send signal>>**;

|#FFF9C4|System|
:Update status = PENDING\n**<<object flow>>**;
:Create notification\n**<<create object>>**;
:Send to Department Head\n**<<send signal>>**;

|#E8F5E9|Department Head|
:Receive notification\n**<<accept event>>**;
:Open review page\n**<<action>>**;
:Read project details\n**<<action>>**;

partition "**Parallel Review Activities**" {
  fork
    :Check curriculum alignment\n**<<evaluation>>**;
  fork again
    :Evaluate project scope\n**<<evaluation>>**;
  fork again
    :Review milestones\n**<<evaluation>>**;
  fork again
    :Check resources\n**<<evaluation>>**;
  end fork
}

:Analyze all criteria\n**<<decision activity>>**;

if (Meets all criteria?) then (<<yes>>)
  
  if (Needs minor revision?) then (<<yes>>)
    :Add review comments\n**<<action>>**;
    :Request revision\n**<<send signal>>**;
    
    |#FFF9C4|System|
    :Update status = DRAFT\n**<<object flow>>**;
    :Notify lecturer\n**<<send signal>>**;
    
    |#E3F2FD|Lecturer|
    :Receive request\n**<<accept event>>**;
    :Read comments\n**<<action>>**;
    :Make revisions\n**<<action>>**;
    :Resubmit\n**<<send signal>>**;
    detach
  else (<<no>>)
  endif
  
  |#E8F5E9|Department Head|
  :Approve project\n**<<decision>>**;
  note right
    **Record:**
    - Approval timestamp
    - Head's comments
    - Conditions (if any)
  end note
  
  |#FFF9C4|System|
  :Update status = APPROVED\n**<<object flow>>**;
  
  fork
    :Notify lecturer\n**<<send signal>>**;
  fork again
    :Add to project pool\n**<<object flow>>**;
  fork again
    :Make visible to students\n**<<object flow>>**;
  end fork
  
  |#E3F2FD|Lecturer|
  :Receive approval\n**<<accept event>>**;
  
  if (Assign to specific class?) then (<<yes>>)
    :Select class\n**<<action>>**;
    :Assign project\n**<<action>>**;
    
    |#FFF9C4|System|
    :Update status = ACTIVE\n**<<object flow>>**;
    :Notify students\n**<<send signal>>**;
    stop
  else (<<no>>)
    :Leave in pool\n**<<object flow>>**;
    note right
      Students can browse
      and select from pool
    end note
    stop
  endif
  
else (<<no>>)
  |#E8F5E9|Department Head|
  :Write rejection reason\n**<<action>>**;
  note right
    **Common reasons:**
    - Out of scope
    - Too complex/simple
    - Duplicate project
    - Resource unavailable
  end note
  
  :Reject project\n**<<decision>>**;
  
  |#FFF9C4|System|
  :Update status = REJECTED\n**<<object flow>>**;
  :Send notification\n**<<send signal>>**;
  
  |#E3F2FD|Lecturer|
  :Receive rejection\n**<<accept event>>**;
  :Read reason\n**<<action>>**;
  
  if (Revise and resubmit?) then (<<yes>>)
    :Create new version\n**<<action>>**;
    note right
      Reference original
      project ID
    end note
    detach
  else (<<no>>)
    :Archive project\n**<<object flow>>**;
    stop
  endif
endif

legend right
  **UML 2.5 Activity Diagram Notation:**
  
  **Activity Nodes:**
  • **<<action>>** - Simple action
  • **<<decision>>** - Approval/rejection decision
  • **<<send signal>>** - Send notification/event
  • **<<accept event>>** - Receive notification/event
  • **<<object flow>>** - Data/object update
  • **<<service call>>** - External API call
  
  **Control Nodes:**
  • Diamond - Decision node (if/else)
  • Black bar - Fork node (parallel start)
  • Black bar - Join node (parallel end)
  • Bullet - Initial node (start)
  • Bull's eye - Final node (stop)
  
  **Swimlanes:**
  • Vertical partitions by actor/role
  • Blue: Lecturer
  • Yellow: System
  • Green: Department Head
  
  **Object States:**
  • DRAFT - Lecturer editing
  • PENDING - Awaiting Head review
  • APPROVED - Ready for assignment
  • ACTIVE - Assigned to class
  • REJECTED - Not approved
  
  **Business Rules:**
  1. Only Department Head can approve/reject
  2. Lecturer can only submit (not approve)
  3. Pending timeout: 7 days → auto-notify
  4. Max 3 resubmissions per project
  5. Rejected projects can be revised
  
  **Time Constraints:**
  • Submission → Review: < 1 hour
  • Review duration: max 7 days
  • Auto-reminder: day 3, day 6
  • Auto-escalate: after day 7
  
  **Notification Channels:**
  • Email (immediate)
  • In-app notification (real-time)
  • Dashboard alert (persistent)
end legend

@enduml
